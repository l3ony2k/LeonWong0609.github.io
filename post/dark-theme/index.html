<html>

<head>
  <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>
  使用 Dark Reader 为博客添加深色主题 | Wonder Space 🚀
</title>

<!-- Chrome, Firefox OS and Opera -->
<meta name="theme-color" content="#ffffff">

<!-- Apple Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<link rel="apple-touch-icon" href="https://ws.l3on.site/images/avatar.png?v=1661055158677">
<meta name="apple-mobile-web-app-title" content="WS 🚀">

<!-- instant.page -->
<script src="https://ws.l3on.site/media/instantpage-5.1.0.js" type="module" defer></script>

<!-- dark reader -->
<script src="https://cdn.jsdelivr.net/npm/darkreader@4.9.26/darkreader.min.js"></script>
<script>
  // Enable when system color scheme is dark.
  DarkReader.auto({
    //brightness: 105,
    //contrast: 95,
    //sepia: 0,
    //grayscale: 15
    darkSchemeBackgroundColor: '#000000',
    darkSchemeTextColor: '#ffffff'
  });
</script>

<link rel="shortcut icon" href="https://ws.l3on.site/favicon.ico?v=1661055158677">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,400;0,700;1,400;1,700&family=IBM+Plex+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.min.css">

<link rel="stylesheet" href="https://ws.l3on.site/styles/main.css">

<!-- umami -->
<script async defer data-website-id="3c0f6b3c-27a9-47bd-9558-913f21633e25" src="https://umami.l3on.site/l3on.js"></script>


    <meta name="description" content="这两天又心血来潮了，想给博客增加深色主题，因为技术的限制，不可能自己重写一套，因此想着尝试使用一键生成深色主题的脚本，尝试了几次之后选择了 Dark Reader（是的就是那个浏览器扩展插件），记录一下。


一些碎碎念
可能是小时候看科幻..." />

    <!-- OG -->
    <meta property="og:locale" content="zh_CN">
    <meta property="og:title" content="使用 Dark Reader 为博客添加深色主题" />
    <meta property="og:type" content="article" />
    <meta property="og:description" content="这两天又心血来潮了，想给博客增加深色主题，因为技术的限制，不可能自己重写一套，因此想着尝试使用一键生成深色主题的脚本，尝试了几次之后选择了 Dark Reader（是的就是那个浏览器扩展插件），记录一下。


一些碎碎念
可能是小时候看科幻...">
    <meta property="og:url" content="https://ws.l3on.site/post/dark-theme/" />
    <meta property="og:site_name" content="Wonder Space 🚀">
    <meta property="og:updated_time" content="01-21-2021">
    <meta property="og:image" content="https://ws.l3on.site/post-images/dark-theme.png" />
    <meta property="og:image:secure_url" content="https://ws.l3on.site/post-images/dark-theme.png">
    <meta property="og:image:alt" content="使用 Dark Reader 为博客添加深色主题">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="使用 Dark Reader 为博客添加深色主题">
    <meta name="twitter:description" content="这两天又心血来潮了，想给博客增加深色主题，因为技术的限制，不可能自己重写一套，因此想着尝试使用一键生成深色主题的脚本，尝试了几次之后选择了 Dark Reader（是的就是那个浏览器扩展插件），记录一下。


一些碎碎念
可能是小时候看科幻...">
    <meta name="twitter:site" content="@WBoy0609">
    <meta name="twitter:creator" content="@WBoy0609">
    <meta name="twitter:image" content="https://ws.l3on.site/post-images/dark-theme.png">

</head>

<body>

  <div id="app" class="main px-4 flex flex-col lg:flex-row">
    <div id="sidebar" class="sidebar-wrapper lg:static lg:w-1/4">
  <div class="lg:sticky top-0">
    <div class="sidebar-content">
      <div class="flex lg:block p-4 lg:px-0 items-center fixed lg:static lg:block top-0 right-0 left-0 bg-white z-50"
        style="backdrop-filter: blur(7px); background: hsla(0, 0%, 100%, .75); -webkit-backdrop-filter: blur(7px);">
        <i class="ri-menu-2-line lg:mt-4 text-2xl cursor-pointer animated fadeIn" onclick="openMenu()"></i>
        <a href="https://ws.l3on.site">
          <img class="animated fadeInLeft avatar rounded-lg mx-4 lg:mt-32 lg:mx-0 mt-0 lg:w-24 lg:h-24 w-12 w-12"
            src="https://ws.l3on.site/images/avatar.png?v=1661055158677" alt="">
        </a>
        <h1 class="animated fadeInLeft lg:text-2xl font-extrabold lg:mt-8 mt-0 text-xl" style="animation-delay: 0.2s">
          Wonder Space 🚀
        </h1>
      </div>
      
          <div class="animated fadeInLeft" style="animation-delay: 0.4s">
            <p class="my-4 text-gray-600 font-light hidden lg:block">
              Contents
            </p>
            <div class="toc-container hidden lg:block">
              <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#%E4%B8%80%E4%BA%9B%E7%A2%8E%E7%A2%8E%E5%BF%B5">一些碎碎念</a></li>
<li><a href="#darkmodejs">Darkmode.Js</a></li>
<li><a href="#dark-reader">Dark Reader</a></li>
<li><a href="#%E5%85%B6%E4%BB%96%E7%A2%8E%E7%A2%8E%E5%BF%B5">其他碎碎念</a></li>
<li><a href="#%E8%A1%A5%E5%85%85">补充</a></li>
</ul>
</li>
</ul>

            </div>
          </div>
          
    </div>
  </div>
</div>

<div class="menu-container">
  <i class="ri-arrow-left-line text-2xl cursor-pointer animated fadeIn close-menu-btn" onclick="closeMenu()"></i>
  <div>
    
      
          <a href="/" class="menu" style="animation-delay: 0s">
            🏠 首页
          </a>
          
            
      
          <a href="/tags" class="menu" style="animation-delay: 0.2s">
            🏷️ 标签
          </a>
          
            
      
          <a href="/archives" class="menu" style="animation-delay: 0.4s">
            📬 归档
          </a>
          
            
      
          <a href="/post/about" class="menu" style="animation-delay: 0.6000000000000001s">
            😶 关于
          </a>
          
            
      
        <a href="https://l3on.site/" class="menu" style="animation-delay: 0.8s" target="_blank">
          ⌨️ Typecho
        </a>
        
            
      
        <a href="https://blog.l3on.site" class="menu" style="animation-delay: 1s" target="_blank">
          🔼 Nobelium
        </a>
        
            
  </div>
  <div class="site-footer">
    <div class="py-4 text-gray-700">
      <a href="/post/about">Wonder Space 🚀</a> by Leon is licensed under a <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">Creative Commons BY-NC-SA 4.0 International License</a>. <img src="https://upload.wikimedia.org/wikipedia/commons/1/12/Cc-by-nc-sa_icon.svg" width="30%" style="margin:5 auto;">
    </div>
    <a class="rss" href="https://ws.l3on.site/atom.xml" target="_blank" style="margin: 5px;">RSS</a>
    <button onclick="DarkReader.disable()" style="margin: 5px;">🌖</button>
    <button onclick="DarkReader.enable({darkSchemeBackgroundColor:'#000000',darkSchemeTextColor:'#ffffff'})"
      style="margin: 5px;">🌒</button>
  </div>
</div>
<div class="mask" onclick="closeMenu()"
  style="backdrop-filter: blur(7px); background: hsla(0, 0%, 100%, 0.5); -webkit-backdrop-filter: blur(7px);">
</div>
      <div class="content-wrapper py-32 lg:p-8 lg:w-3/4 post-detail animated fadeIn">
        <h1 class="text-3xl font-bold lg:mt-16">
          使用 Dark Reader 为博客添加深色主题
        </h1>
        <div class="text-sm text-gray-700 lg:my-8">
          01-21-2021 / 9 min read
        </div>
        
          <img class="post-feature-image rounded-lg mx-auto my-4" src="https://ws.l3on.site/post-images/dark-theme.png" alt="">
          
            <div class="post-content yue">
              <p>这两天又心血来潮了，想给博客增加深色主题，因为技术的限制，不可能自己重写一套，因此想着尝试使用一键生成深色主题的脚本，尝试了几次之后选择了 Dark Reader（是的就是那个浏览器扩展插件），记录一下。</p>
<!-- more -->
<hr>
<h2 id="一些碎碎念">一些碎碎念</h2>
<p>可能是小时候看科幻片的影响，我一直很喜欢黑色背景上面闪烁着亮色文字的交互界面。初中刚毕业有自己的手机之后，就给手机刷上了 CyanogenMod，然后把能搜到的深色主题一个个尝试。当时用的三星 Galaxy S6，OLED 屏幕下全黑色像素不发光的特性只让我觉得深色界面更酷了，完全不在乎烧屏这回事。我记得当时很多 CM 主题都包括了对国外常用软件的界面修改（Instagram 之类的），而对于国内的应用就没什么办法。所以当时还用 Xposed 框架上的一个模块来修改微信的界面，再替换微信的聊天背景，才能让微信的对话界面达到相对统一的暗色。</p>
<p>后来到高中以后，我的手机又换成了家人「退役」的 iPhone，玩手机的时间也大大减少，更关键的是手里的 iPhone 前面板是白色的，一段时间内就都没有特意追求过深色界面了。然而后来 iPhone 也换用了 OLED 屏幕，iOS 13 更是直接加上了系统级的深色模式界面，在 iOS 的号召力下，众多国内应用也开始适配深色模式了。前段时间微信也终于增加了深色模式，又是一个「有生之年」的事件实现了。</p>
<p>至于桌面端，微软在前段时间的某个版本也加入了深色模式，主要使用的一些软件也基本都有深色模式的适配（除了 Evernote）。至于浏览器，自从发现了 Dark Reader 这个插件之后，就从来没有换过，插件自动优化的效果也很好，我也就基本上也实现了桌面端深色界面的覆盖。</p>
<p>除了使用插件之外，越来越多的网站也适配了深色模式，我常用的一些网站包括少数派、GitHub 之类的也陆陆续续从我的 Dark Reader 名单里排除了。然而受制于水平，我自己的博客却从来没适配上深色模式。虽然说 Walker 这个主题的白色已经足够简洁优雅，但是我一直觉得如果能加上深色模式的话，虽然没什么用，但是会很酷。这个理由对我来说足够了。</p>
<p>说干就干，我觉得既然 Dark Reader 能对每个网站都能实现效果相对比较好的深色模式适配，那么网上一定有人造了自动生成网页深色模式的轮子，可以的话我拿来用就好。</p>
<hr>
<h2 id="darkmodejs">Darkmode.Js</h2>
<p>做了一些搜索之后，我最先发现的是一个叫 Darkmode.Js 的项目，在 <a href="https://darkmodejs.learn.uno/">官网</a> 就能预览这个脚本的效果，一个小按钮会漂浮在网页右下角，点击一次之后还会有平滑的过渡动画，网页嵌在了下面，只要点击右下角的图标就可以看到效果。</p>
<p>
<div style="width:100%;height:500px;overflow:hidden;border:0px">
<div style="width:100%;height:500px;margin: 0px 0px 0px 0px;">
<iframe src="https://darkmodejs.learn.uno/" style="width: 100%;margin: 0;padding: 0;border: 0;height:500px;" scrolling="yes">
</iframe>
</div>
</div>
</p>
<p><small>👆 Darkmode.Js 的官网，点击右下角的 🌓 图标可以切换网页主题</small></p>
<p>适配到自己网站也特别简单只要按照教程 include 到自己的网页就可以了。然而试了一下之后效果并不满意，这个实现的效果有点像静态反色，对于已经设定了背景色的元素会选择直接不做修改。因为网站的主题代码我自己修改过，可能有些地方不太规范，所以这个脚本不能实现很好的效果，我当时也没想到要写这篇博文，也就没有截图。</p>
<h2 id="dark-reader">Dark Reader</h2>
<p>之前说过 Walker 这个主题颜色比较简单，因此在开启 Dark Reader 插件的时候，自动生成的深色模式效果一直很好。我就在想，既然 Dark Reader 是开源的，会不会有人做过能利用 Dark Reader 的代码直接生成网页深色模式的脚本呢。于是我去 Dark Reader 的开源仓库上一看，开发者给出了在自己的网站使用 Dark Reader 的 <a href="https://github.com/darkreader/darkreader#using-for-a-website">方式</a>。</p>
<p>我们只需要通过 jsDelivr 来把脚本 include 到自己的网页中，就可以使用开发者提供的 API 了。我在网页中使用了根据设备系统设置自动选择是否启用深色模式，那么就在 <code>head.ejs</code> 添加以下内容：</p>
<pre><code class="language-html">&lt;!-- dark reader --&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/darkreader@4.9.26/darkreader.min.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;
    // Enable when system color scheme is dark.
    DarkReader.auto({
        brightness: 105,
        contrast: 95,
        sepia: 0,
        grayscale: 15
    });
&lt;/script&gt;
</code></pre>
<p>但是我还是希望可以增加一个可以自由选择颜色主题的选项，无奈一方面水平不够，另一方面也不想打破网站原有的设计，所以找了 sidebar 里 footer 的位置，RSS 链接的旁边加入了两个按钮：</p>
<pre><code class="language-html">&lt;div class=&quot;site-footer&quot;&gt;
    &lt;div class=&quot;py-4 text-gray-700&quot;&gt;&lt;%- themeConfig.footerInfo %&gt;&lt;/div&gt;
    &lt;a class=&quot;rss&quot; href=&quot;&lt;%= themeConfig.domain %&gt;/atom.xml&quot; target=&quot;_blank&quot; style=&quot;margin: 5px;&quot;&gt;RSS&lt;/a&gt;
    &lt;button onclick=&quot;DarkReader.disable()&quot; style=&quot;margin: 5px;&quot;&gt;🌖&lt;/button&gt;
    &lt;button onclick=&quot;DarkReader.enable({brightness: 105, contrast: 95, sepia: 0, grayscale: 15})&quot; style=&quot;margin: 5px;&quot;&gt;🌒&lt;/button&gt;
&lt;/div&gt;
</code></pre>
<p>最后的实现效果如图，点击亮的月亮就是切换成亮色模式，暗的月亮就是深色模式。</p>
<figure data-type="image" tabindex="1"><img src="https://ws.l3on.site/post-images/1611325163678.png" alt="" width="500" loading="lazy"></figure>
<p>直接点开左上角的菜单栏就可以直接试试效果啦！</p>
<h2 id="其他碎碎念">其他碎碎念</h2>
<p>总体来说使用现有的脚本来添加网页的深色模式比我原来想象的简单很多，尤其是使用 Dark Reader 之后，一些我自己乱加的毛玻璃效果都能得到很好的适配。或许在这些各种强大工具的加持下，以后将创意实现的难度会越来越低，这样看来，未来各种设计类工作中技术作为竞争力的重要程度也许会越来越低，真正重要的可能就只有创意了。</p>
<h2 id="补充">补充</h2>
<p>使用 Dark Reader 为博客成功添加深色主题后，内心还有一点小遗憾。我个人偏好 0 饱和度的深色模式，也就是不希望在深色中加入偏色。但是 Dark Reader 可能是处于护眼的考虑，默认的背景色和文字颜色都有少许的偏黄。以前使用插件时也一直存在这个遗憾，但是最近的一次更新让 Dark Reader 能够指定主题的背景色和文字颜色。</p>
<p>打开的方式也很简单，只需点击打开插件后点击右下角的 <code>Dev tools</code> ，</p>
<figure data-type="image" tabindex="2"><img src="https://raw.githubusercontent.com/LeonWong0609/LeonPicbed/master/20210704004807.png" alt="插件设置" loading="lazy"></figure>
<p>在弹出来的窗口中点击右下角的 <code>Preview new design</code>，</p>
<figure data-type="image" tabindex="3"><img src="https://raw.githubusercontent.com/LeonWong0609/LeonPicbed/master/20210704005008.png" alt="预览新界面" width="500" loading="lazy"></figure>
<p>完成后再点击插件图标，看到的就会是新的界面了。</p>
<figure data-type="image" tabindex="4"><img src="https://raw.githubusercontent.com/LeonWong0609/LeonPicbed/master/20210704005452.png" alt="插件新界面" loading="lazy"></figure>
<p>这时就可以通过设置指定背景颜色和文字颜色，甚至可以指定是否要更改滚动条和选取文字的背景颜色。</p>
<p>这就启发了我思考 Dark Reader 提供的脚本能不能指定背景颜色和文字颜色，当时想着有空就做，结果一不小心鸽了大半年。正好今天背书背到自闭，无聊翻 GitHub 的时候突然想到这件事，于是就去看了一眼他们的 <a href="https://cdn.jsdelivr.net/npm/darkreader@latest/darkreader.js">脚本内容</a>，简单搜索了一下就发现了这一段</p>
<pre><code class="language-js">var themeCacheKeys = [
    'mode',
    'brightness',
    'contrast',
    'grayscale',
    'sepia',
    'darkSchemeBackgroundColor',
    'darkSchemeTextColor',
    'lightSchemeBackgroundColor',
    'lightSchemeTextColor',
];
</code></pre>
<p>于是我就把 <code>head.ejs</code> 里添加的内容改成了这样</p>
<pre><code class="language-html">&lt;!-- dark reader --&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/darkreader@4.9.26/darkreader.min.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;
    // Enable when system color scheme is dark.
    DarkReader.auto({
        darkSchemeBackgroundColor: '#121212',
        darkSchemeTextColor: '#ffffff'
    });
&lt;/script&gt;
</code></pre>
<p>重试了一下竟然就成功了，现在再用深色模式看这个网页，背景和文字终于是舒服的灰色，而不会偏黄了。</p>
<p>本来到这里打算合电脑睡觉了，结果发现上面 side bar 里的两个中启动深色模式的那个按钮还是指定的原来的颜色，一点就又回到了偏黄的颜色了。于是把第二个按钮也改了一下：</p>
<pre><code class="language-html">&lt;button onclick=&quot;DarkReader.enable({darkSchemeBackgroundColor:'#121212',darkSchemeTextColor:'#ffffff'})&quot; style=&quot;margin: 5px;&quot;&gt;🌒&lt;/button&gt;
</code></pre>
<p>这样颜色终于就没问题了。但是还是存在改动了主题之后刷新一下页面又回到默认主题的情况，我猜如果要解决这个问题可能就要把指定的主题写到 cookie 里面了吧，远远超出我的能力范围，就有缘再做吧。</p>

            </div>

            
              <a class="animated fadeInUp p-2 items-center text-sm text-gray-700 border hover:bg-gray-300 leading-none rounded-full flex lg:inline-flex m-4 "
                href="https://ws.l3on.site/tag/86oOp5QCV/">
                <span class="flex-auto">
                  博客
                </span>
              </a>
              


                <div class="flex justify-between py-8">
                  
                    <div class="prev-post">
                      <a href="https://ws.l3on.site/post/go-running/">
                        <h3 class="post-title">
                          <i class="ri-arrow-left-line"></i>
                          痛苦的时候就去跑步吧
                        </h3>
                      </a>
                    </div>
                    

                      
                        <div class="next-post">
                          <a href="https://ws.l3on.site/post/add-open-graph-to-my-blog/">
                            <h3 class="post-title">
                              让博客在社交媒体的预览效果更丰富：OG 协议
                                <i class="ri-arrow-right-line"></i>
                            </h3>
                          </a>
                        </div>
                        
                </div>

                

<script src="https://giscus.app/client.js"
    data-repo="LeonWong0609/LeonWong0609.github.io"
    data-repo-id="MDEwOlJlcG9zaXRvcnkyMjcyODI0NTM="
    data-category="General"
    data-category-id="DIC_kwDODYwOFc4COnst"
    data-mapping="title"
    data-reactions-enabled="1"
    data-emit-metadata="1"
    data-input-position="top"
    data-theme="transparent_dark"
    data-lang="zh-CN"
    data-loading="lazy"
    crossorigin="anonymous"
    async>
</script>

      </div>
  </div>

  <script src="https://ws.l3on.site/media/prism.js"></script>

<script>

  Prism.highlightAll()
  let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

  // This should probably be throttled.
  // Especially because it triggers during smooth scrolling.
  // https://lodash.com/docs/4.17.10#throttle
  // You could do like...
  // window.addEventListener("scroll", () => {
  //    _.throttle(doThatStuff, 100);
  // });
  // Only not doing it here to keep this Pen dependency-free.

  window.addEventListener("scroll", event => {
    let fromTop = window.scrollY;

    mainNavLinks.forEach((link, index) => {
      let section = document.getElementById(decodeURI(link.hash).substring(1));
      let nextSection = null
      if (mainNavLinks[index + 1]) {
        nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
      }
      if (section.offsetTop <= fromTop) {
        if (nextSection) {
          if (nextSection.offsetTop > fromTop) {
            link.classList.add("current");
          } else {
            link.classList.remove("current");
          }
        } else {
          link.classList.add("current");
        }
      } else {
        link.classList.remove("current");
      }
    });
  });


  document.addEventListener("DOMContentLoaded", function () {
    var lazyImages = [].slice.call(document.querySelectorAll(".post-feature-image.lazy"));

    if ("IntersectionObserver" in window) {
      let lazyImageObserver = new IntersectionObserver(function (entries, observer) {
        entries.forEach(function (entry) {
          if (entry.isIntersecting) {
            let lazyImage = entry.target
            lazyImage.style.backgroundImage = `url(${lazyImage.dataset.bg})`
            lazyImage.classList.remove("lazy")
            lazyImageObserver.unobserve(lazyImage)
          }
        });
      });

      lazyImages.forEach(function (lazyImage) {
        lazyImageObserver.observe(lazyImage)
      })
    } else {
      // Possibly fall back to a more compatible method here
    }
  });

  const menuContainer = document.querySelector('.menu-container')
  const menus = document.querySelectorAll('.menu-container .menu')
  const mask = document.querySelector('.mask')
  const contentWrapper = document.querySelector('.content-wrapper')
  const latestArticle = document.querySelector('.latest-article')
  const readMore = document.querySelector('.read-more')
  const indexPage = document.querySelector('.index-page')

  const isHome = location.pathname === '/'
  if (latestArticle) {
    latestArticle.style.display = isHome ? 'block' : 'none'
    readMore.style.display = isHome ? 'block' : 'none'
    indexPage.style.display = isHome ? 'none' : 'block'
  }

  const openMenu = () => {
    menuContainer.classList.add('open')
    menus.forEach(menu => {
      menu.classList.add('animated', 'fadeInLeft')
    })
    mask.classList.add('open')
    contentWrapper.classList.add('is-second')
  }

  const closeMenu = () => {
    menuContainer.classList.remove('open')
    menus.forEach(menu => {
      menu.classList.remove('animated', 'fadeInLeft')
    })
    mask.classList.remove('open')
    contentWrapper.classList.remove('is-second')
  }
</script>
</body>

</html>