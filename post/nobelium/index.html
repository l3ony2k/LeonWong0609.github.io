<html>

<head>
  <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>
  记录新博客：nobelium, Vercel, Tailwind CSS 和域名 | Wonder Space 🚀
</title>

<!-- Chrome, Firefox OS and Opera -->
<meta name="theme-color" content="#ffffff">

<!-- Apple Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<link rel="apple-touch-icon" href="https://ws.l3on.site/images/avatar.png?v=1661055158677">
<meta name="apple-mobile-web-app-title" content="WS 🚀">

<!-- instant.page -->
<script src="https://ws.l3on.site/media/instantpage-5.1.0.js" type="module" defer></script>

<!-- dark reader -->
<script src="https://cdn.jsdelivr.net/npm/darkreader@4.9.26/darkreader.min.js"></script>
<script>
  // Enable when system color scheme is dark.
  DarkReader.auto({
    //brightness: 105,
    //contrast: 95,
    //sepia: 0,
    //grayscale: 15
    darkSchemeBackgroundColor: '#000000',
    darkSchemeTextColor: '#ffffff'
  });
</script>

<link rel="shortcut icon" href="https://ws.l3on.site/favicon.ico?v=1661055158677">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,400;0,700;1,400;1,700&family=IBM+Plex+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.min.css">

<link rel="stylesheet" href="https://ws.l3on.site/styles/main.css">

<!-- umami -->
<script async defer data-website-id="3c0f6b3c-27a9-47bd-9558-913f21633e25" src="https://umami.l3on.site/l3on.js"></script>


    <meta name="description" content="长文预警（一不小心写了一万多字…… 真希望我写论文有这动力）。这几天可能是为了逃避一些现实的压力，我疯狂折腾了几天。用 nobelium 搭建了一个新的博客，折腾了一下 Tailwind CSS，顺便买了一个域名，给自己的博客都上了自己的域..." />

    <!-- OG -->
    <meta property="og:locale" content="zh_CN">
    <meta property="og:title" content="记录新博客：nobelium, Vercel, Tailwind CSS 和域名" />
    <meta property="og:type" content="article" />
    <meta property="og:description" content="长文预警（一不小心写了一万多字…… 真希望我写论文有这动力）。这几天可能是为了逃避一些现实的压力，我疯狂折腾了几天。用 nobelium 搭建了一个新的博客，折腾了一下 Tailwind CSS，顺便买了一个域名，给自己的博客都上了自己的域...">
    <meta property="og:url" content="https://ws.l3on.site/post/nobelium/" />
    <meta property="og:site_name" content="Wonder Space 🚀">
    <meta property="og:updated_time" content="03-11-2022">
    <meta property="og:image" content="https://vip1.loli.io/2022/04/15/g5SLBecNh2u8XOC.png" />
    <meta property="og:image:secure_url" content="https://vip1.loli.io/2022/04/15/g5SLBecNh2u8XOC.png">
    <meta property="og:image:alt" content="记录新博客：nobelium, Vercel, Tailwind CSS 和域名">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="记录新博客：nobelium, Vercel, Tailwind CSS 和域名">
    <meta name="twitter:description" content="长文预警（一不小心写了一万多字…… 真希望我写论文有这动力）。这几天可能是为了逃避一些现实的压力，我疯狂折腾了几天。用 nobelium 搭建了一个新的博客，折腾了一下 Tailwind CSS，顺便买了一个域名，给自己的博客都上了自己的域...">
    <meta name="twitter:site" content="@WBoy0609">
    <meta name="twitter:creator" content="@WBoy0609">
    <meta name="twitter:image" content="https://vip1.loli.io/2022/04/15/g5SLBecNh2u8XOC.png">

</head>

<body>

  <div id="app" class="main px-4 flex flex-col lg:flex-row">
    <div id="sidebar" class="sidebar-wrapper lg:static lg:w-1/4">
  <div class="lg:sticky top-0">
    <div class="sidebar-content">
      <div class="flex lg:block p-4 lg:px-0 items-center fixed lg:static lg:block top-0 right-0 left-0 bg-white z-50"
        style="backdrop-filter: blur(7px); background: hsla(0, 0%, 100%, .75); -webkit-backdrop-filter: blur(7px);">
        <i class="ri-menu-2-line lg:mt-4 text-2xl cursor-pointer animated fadeIn" onclick="openMenu()"></i>
        <a href="https://ws.l3on.site">
          <img class="animated fadeInLeft avatar rounded-lg mx-4 lg:mt-32 lg:mx-0 mt-0 lg:w-24 lg:h-24 w-12 w-12"
            src="https://ws.l3on.site/images/avatar.png?v=1661055158677" alt="">
        </a>
        <h1 class="animated fadeInLeft lg:text-2xl font-extrabold lg:mt-8 mt-0 text-xl" style="animation-delay: 0.2s">
          Wonder Space 🚀
        </h1>
      </div>
      
          <div class="animated fadeInLeft" style="animation-delay: 0.4s">
            <p class="my-4 text-gray-600 font-light hidden lg:block">
              Contents
            </p>
            <div class="toc-container hidden lg:block">
              <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#%E9%83%A8%E7%BD%B2%E8%BF%87%E7%A8%8B">部署过程</a></li>
<li><a href="#%E5%BC%80%E5%A7%8B%E8%87%AA%E5%B7%B1%E6%8A%98%E8%85%BE">开始自己折腾</a>
<ul>
<li><a href="#blogconfig">blog.config</a></li>
<li><a href="#%E5%A4%B4%E5%83%8Fgravatar">头像：Gravatar</a></li>
<li><a href="#%E8%AF%84%E8%AE%BAcusdis">评论：Cusdis</a></li>
<li><a href="#tailwind-css">Tailwind CSS</a></li>
<li><a href="#og-image">OG image</a></li>
</ul>
</li>
<li><a href="#%E4%BC%98%E5%8A%BF">优势</a></li>
<li><a href="#%E5%9F%9F%E5%90%8D">域名</a></li>
<li><a href="#%E6%80%BB%E7%BB%93">总结</a></li>
</ul>
</li>
</ul>

            </div>
          </div>
          
    </div>
  </div>
</div>

<div class="menu-container">
  <i class="ri-arrow-left-line text-2xl cursor-pointer animated fadeIn close-menu-btn" onclick="closeMenu()"></i>
  <div>
    
      
          <a href="/" class="menu" style="animation-delay: 0s">
            🏠 首页
          </a>
          
            
      
          <a href="/tags" class="menu" style="animation-delay: 0.2s">
            🏷️ 标签
          </a>
          
            
      
          <a href="/archives" class="menu" style="animation-delay: 0.4s">
            📬 归档
          </a>
          
            
      
          <a href="/post/about" class="menu" style="animation-delay: 0.6000000000000001s">
            😶 关于
          </a>
          
            
      
        <a href="https://l3on.site/" class="menu" style="animation-delay: 0.8s" target="_blank">
          ⌨️ Typecho
        </a>
        
            
      
        <a href="https://blog.l3on.site" class="menu" style="animation-delay: 1s" target="_blank">
          🔼 Nobelium
        </a>
        
            
  </div>
  <div class="site-footer">
    <div class="py-4 text-gray-700">
      <a href="/post/about">Wonder Space 🚀</a> by Leon is licensed under a <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">Creative Commons BY-NC-SA 4.0 International License</a>. <img src="https://upload.wikimedia.org/wikipedia/commons/1/12/Cc-by-nc-sa_icon.svg" width="30%" style="margin:5 auto;">
    </div>
    <a class="rss" href="https://ws.l3on.site/atom.xml" target="_blank" style="margin: 5px;">RSS</a>
    <button onclick="DarkReader.disable()" style="margin: 5px;">🌖</button>
    <button onclick="DarkReader.enable({darkSchemeBackgroundColor:'#000000',darkSchemeTextColor:'#ffffff'})"
      style="margin: 5px;">🌒</button>
  </div>
</div>
<div class="mask" onclick="closeMenu()"
  style="backdrop-filter: blur(7px); background: hsla(0, 0%, 100%, 0.5); -webkit-backdrop-filter: blur(7px);">
</div>
      <div class="content-wrapper py-32 lg:p-8 lg:w-3/4 post-detail animated fadeIn">
        <h1 class="text-3xl font-bold lg:mt-16">
          记录新博客：nobelium, Vercel, Tailwind CSS 和域名
        </h1>
        <div class="text-sm text-gray-700 lg:my-8">
          03-11-2022 / 25 min read
        </div>
        
          <img class="post-feature-image rounded-lg mx-auto my-4" src="https://vip1.loli.io/2022/04/15/g5SLBecNh2u8XOC.png" alt="">
          
            <div class="post-content yue">
              <p>长文预警（一不小心写了一万多字…… 真希望我写论文有这动力）。这几天可能是为了逃避一些现实的压力，我疯狂折腾了几天。用 <a href="https://github.com/LeonWong0609/nobelium/">nobelium</a> 搭建了一个新的博客，折腾了一下 Tailwind CSS，顺便买了一个域名，给自己的博客都上了自己的域名。</p>
<!-- more -->
<p>其实去年的时候我就发现了 <a href="https://github.com/LeonWong0609/nobelium/">nobelium</a> 这个项目，也成功搭建了，但是网站的排版样式我一直想调整一下，但是当时不会也没花时间折腾，这几天我就集中现学现卖折腾了一下。</p>
<h2 id="部署过程">部署过程</h2>
<p>如何搭建在 nobelium 的 <a href="https://github.com/craigary/nobelium#quick-start">README</a> 中已经描述的十分清楚，这里简单叙述一下。首先需要准备的是 GitHub 账号，Notion 账号和 Vercel 账号（可以直接用 GitHub 登录），Fork 一下 craigary/nobelium 这个仓库。</p>
<figure data-type="image" tabindex="1"><img src="https://ws.l3on.site/post-images/4b02dbcf-2664-4d8e-be73-df09fe9ba60d.png" alt="" loading="lazy"></figure>
<p>然后 Duplicate 一下 craigary 提供的 <a href="https://craigary.notion.site/adc3552cfc73442ab5048d4b1eb0079a">Notion 模板</a>（一个 database）到自己的 Notion 账号，在自己的 Notion 中分享这个 database。</p>
<figure data-type="image" tabindex="2"><img src="https://ws.l3on.site/post-images/9c5d8e0d-23c4-4e2a-9774-2aa4a12d4bdc.png" alt="" loading="lazy"></figure>
<p>分享之后需要记录一下自己的 Page ID，每个 database 都不一样，craigary 的这张图说明十分清楚。</p>
<figure data-type="image" tabindex="3"><img src="https://ws.l3on.site/post-images/fde0efc8-db27-46e0-9dbc-c080616075c5.png" alt="" loading="lazy"></figure>
<p>再登录 Vercel，选择新建项目，从 GitHub 中导入刚刚 Fork 的仓库，操作都比较符合直觉，这里就不截图了，然后选择 Next.js 框架。然后，设置好环境变量，名称为 <code>NOTION_PAGE_ID</code> ，内容为自己页面的 Page ID，让 Vercel 自动部署。</p>
<figure data-type="image" tabindex="4"><img src="https://ws.l3on.site/post-images/ecfe59c4-461b-4efc-bd8e-47b56e352d58.png" alt="" loading="lazy"></figure>
<figure data-type="image" tabindex="5"><img src="https://ws.l3on.site/post-images/eb59c5bd-c689-47dd-9394-79d3f914c064.png" alt="" loading="lazy"></figure>
<p>部署成功之后，访问 Vercel 提供的网址，应该就可以看到内容了。这时候可以看看那个模板 database，里面的每个属性的含义应该都很清楚了</p>
<ul>
<li>title: 文章的标题；</li>
<li>date: 文章发布的时间，如果留空默认是文章创建的时间；</li>
<li>slug: 文章 URL 尾部的字符，也就是 <code>.com/xxx</code> 中 xxx 的部分，建议使用英文，用 <code>-</code> 代替空格，如果使用中文或者空格、标点，会被 UrlEncode 变成一长串，链接会显得很长；</li>
<li>summary: 文章简介，会显示在主页标题的底部；</li>
<li>tags: 文章标签，可以对文章进行分类；</li>
<li>status: 文章状态，只有 <code>Published</code> 状态的文章会在博客公开显示；</li>
<li>type: <code>Post</code> 会直接显示在主页，<code>Page</code> 只有直接访问 URL 会显示，不会出现在主页文章列表中。</li>
</ul>
<p>我个人使用了 Notion 的 Group（分组）功能把这个 database 按照 status 进行了分组，这样我能更方便集中管理已经发布和未发布的内容。</p>
<figure data-type="image" tabindex="6"><img src="https://ws.l3on.site/post-images/c3010767-0261-4aa8-96bd-fd5b6096bec2.png" alt="" loading="lazy"></figure>
<p>之后，我找了几篇以前写的东西，粘贴到了 Notion 模板里，再回到博客，直接刷新页面就可以看到文章了。</p>
<h2 id="开始自己折腾">开始自己折腾</h2>
<h3 id="blogconfig">blog.config</h3>
<p>把自己 Fork 的仓库 clone 到本地，就可以开始折腾了。</p>
<p>按照 README 中的介绍，可以修改 <code>blog.config.js</code> 文件对博客进行第一步的自定义。可以自定义的内容在文件中也有很详细的注释了，不要修改作者注释了 do not change 的地方。这里介绍两个我觉得需要注意的地方。</p>
<ul>
<li>首先是 <code>email</code> 要记住自己填写了什么，因为和头像有关，后面再详细说明；</li>
<li>其次 <code>comment</code> 我个人选择了 Cusdis 而不是 Gitalk，后面也会详细说明。</li>
</ul>
<h3 id="头像gravatar">头像：<a href="https://gravatar.com/">Gravatar</a></h3>
<p>默认状态下，nobelium 的头像是 这样的：</p>
<figure data-type="image" tabindex="7"><img src="https://ws.l3on.site/post-images/9d517f15-9380-450c-9b23-72cdb1a0009b.png" alt="" width="100" loading="lazy"></figure>
<p>十分眼熟，因为这是 Gravatar 的默认头像。需要到 <a href="https://gravatar.com">Gravatar 官网</a> 注册一个账号（用 WordPress）账号也可以，注意这里要用刚才在 <code>email</code> 中填写的邮箱注册，然后按照提示上传头像，成功后等待一会，博客应该就会刷新出自己的头像了。</p>
<p>原理应该就是 nobelium 会自动使用 Gravatar 生成的头像 URL 获取头像，只需要在 <code>https://gravatar.com/avatar/</code> 后加上注册邮箱的 md5 值，就可以直接获取头像了，在 <code>layout.js</code> Ln45 可以看到。</p>
<h3 id="评论cusdis">评论：<a href="https://cusdis.com">Cusdis</a></h3>
<p>以前在 Gridea 使用的评论系统是 Gittalk，和仓库绑定后，就可以通过 issue 实现评论功能，可以支持 Markdown，只要有 GitHub 账号就可以评论。但是体验上还是有点沉重，在国内的互联网环境更是经常加载不出来，也有人认为这是对 GitHub 的 issue 功能的误用。但对我来说最难受的部分还是自定义样式比较难。</p>
<p>所以这次在 nobelium 发现 Cusdis 之后就试了试，结果很惊喜。按照官网的介绍，Cusdis 是 Disqus 的轻量开源替代，大小只有 5kb，设置成功后基本上是和网页同步加载成功，而且不需要注册任何账号就可以评论。</p>
<figure data-type="image" tabindex="8"><img src="https://ws.l3on.site/post-images/a87a79ec-81b2-4e04-a4ce-f862f4651690.png" alt="" loading="lazy"></figure>
<p>Cusdis 可以选择自己部署，也可以使用官方提供的服务器。只需要在官网注册账号，添加一个网站，记住 <code>data-app-id</code>，并填写到 <code>blog.config.js</code> 对应的位置，如果使用官方提供的服务器，可以直接按照这样填写：</p>
<pre><code class="language-javascript">cusdisConfig: {
  appId: '替换自己的 data-app-id', // data-app-id
  host: 'https://cusdis.com', // data-host, change this if you're using self-hosted version
  scriptSrc: 'https://cusdis.com/js/cusdis.es.js' // change this if you're using self-hosted version
}
</code></pre>
<p>完成后就可以把所有的更改 push 到 GitHub，等待 Vercel 部署完成，就可以刷新查看成果了！</p>
<h3 id="tailwind-css">Tailwind CSS</h3>
<p>以上是最基本的自定义，但对于我这种折腾的人肯定不能满足，我还是喜欢折腾 CSS。</p>
<p>第一天刚刚搭建好 nobelium 的时候我其实就已经折腾了一下样式，但是由于没有仔细看文档，上来我就修改了仓库里比较明显的 <code>global.css</code>  和 <code>notion.css</code>  两个文件，不管里面本来看不懂的内容，直接配合检查工具直接把自己想用的样式用 CSS 硬写了一些，然后野蛮地加上 <code>!important</code> ，强制生效。然而第二天的时候我仔细看了看 nobelium 的文档，发现 nobelium 在介绍中也说自己使用的是 Tailwind CSS / JIT 框架，方便自定义，于是我就查了一下这个似曾相识的名字，发现我错过了太多，之前的自定义基本也就是野路子，实在不算优雅。</p>
<p>我说说我简单的理解，nobelium 的两个 CSS 文件其实是负责两个部分 <code>global.css</code> 主要负责整体的框架，包括导航栏、首页、footer、文章作者等部分；<code>notion.css</code> 主要负责文章正文部分。可以理解为 nobelium 是为 Notion 中的内容提供了一个展示的框架，正文外的其他内容由 nobelium 生成，然后从 Notion 中取正文内容再通过指定的样式渲染，最终展现一个完整的博客。</p>
<p>回到 Tailwind CSS 上，根据我的理解，Tailwind CSS 提供的是一种快速在 HTML 文件中指定样式的框架，只需要在 HTML 元素中指定一些特定的 class，就可以自动生成对应的 CSS 属性，从而达到不离开 HTML 文件快速实现样式自定义的效果。因此再回到两个 CSS 文件中，其中的内容便似乎可以看得懂了。</p>
<p>举个例子，在 <code>notion.css</code> 文件中我自定义了这些：</p>
<pre><code class="language-css">.notion-h1, .notion-h2, .notion-h3 {
  @apply mb-2;
  @apply text-left;
}
</code></pre>
<p>由于是在 CSS 中使用 Tailwind，所以选择器的规则和 CSS 一样，然后在 <code>@apply</code> 后的内容就是 Tailwind CSS 的「语法」了。 <code>mb-2</code> 是代表 <code>margin-bottom: 0.5rem; /* 8px */</code> ，<code>text-left</code> 代表 <code>text-align: left;</code> 。</p>
<p>然而并不是所有的样式都在这两个 CSS 中被指定，前面说 Tailwind CSS 最主要的功能是在 HTML 文件中快速指定样式，因此我们还可以在生成 HTML 文件的几个 js 文件中找到 Tailwind CSS 的痕迹。</p>
<p>再举个例子，<code>BlogPost.js</code> 我修改成了这样：</p>
<pre><code class="language-javascript">const BlogPost = ({ post }) =&gt; {
  return (
    &lt;Link href={`${BLOG.path}/${post.slug}`}&gt;
      &lt;a&gt;
        &lt;article key={post.id} className=&quot;mb-6 md:mb-8&quot;&gt;
          &lt;header className=&quot;flex flex-col justify-between md:flex-row md:items-baseline&quot;&gt;
            &lt;h2 className=&quot;text-lg md:text-xl font-bold mb-2 cursor-pointer text-black dark:text-gray-200&quot;&gt;
              {post.title}
            &lt;/h2&gt;
            &lt;time className=&quot;flex-shrink-0 text-gray-600 dark:text-gray-500&quot;&gt;
              {formatDate(post?.date?.start_date || post.createdTime, BLOG.lang)}
            &lt;/time&gt;
          &lt;/header&gt;
          &lt;main&gt;
            &lt;p className=&quot;hidden md:block leading-7 text-gray-700 dark:text-gray-400&quot;&gt;
              {post.summary}
            &lt;/p&gt;
          &lt;/main&gt;
        &lt;/article&gt;
      &lt;/a&gt;
    &lt;/Link&gt;
  )
}
</code></pre>
<p>这个文件其实就是主页的显示效果，我想把简介的文字调暗一点，让文章标题文字更加突出，于是将最后一个 <code>&lt;p&gt;</code> 元素的 <code>className</code> 修改为 <code>text-gray-700</code> 和 <code>dark:text-gray-400</code>，查阅文档可知 <code>text-color-###</code> 代表字体颜色为指定的颜色，其中 <code>gray-700</code> 是 Tailwind CSS 默认调色盘中的一种灰色，而 <code>dark:</code> 前缀代表在系统深色模式下适用，所以代表在深色模式下，这里文字颜色使用 <code>gray-400</code> 颜色，比原来的更暗一些，可以实现我的效果。</p>
<p>如此类推，详细的对应关系可以在 Tailwind CSS 的 <a href="https://tailwindcss.com/docs/">官方文档</a> 中找到，文档有很方便的搜索功能，作为纯业余的我折腾体验也不错。另外网上还有 <a href="https://www.tailwindcss.cn/docs">中文翻译版的文档</a> 可供参考。</p>
<p>之后，可以再对一些元素进行进一步的修改，例如我给 footer 加上了 CC BY-NC-SA 的图标，并超链接到博客的版权页，拿掉了原来 Vercel 的徽章（放到了关于页里）。</p>
<h3 id="og-image">OG image</h3>
<p>折腾完以上的部分之后休息了一天，今天又心痒了看了看项目文件，发现在 <code>blog.config.js</code> 文件中的 <code>ogImageGenerateURL</code> 。这也是 nobelium 的一个 feature 之一，自带 Open Graph，但我折腾之后又发现了一些问题。</p>
<p>在原来的文件中，填写的是 craigary 自己部署的一个域名，在 <code>Container.js</code> 文件中 Ln39 被引用：</p>
<pre><code class="language-html">&lt;meta
  property=&quot;og:image&quot;
  content={`${BLOG.ogImageGenerateURL}/${encodeURIComponent(
    meta.title
  )}.png？theme=dark&amp;md=1&amp;fontSize=125px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fvercel-triangle-white.svg&amp;images=https%3A%2F%2Fgithub.com%2FLeonWong0609%2Fnobelium%2Fraw%2Fmain%2FNobelium-Logo.svg&amp;widths=200&amp;widths=200&amp;heights=undefined&amp;heights=200`}
/&gt;
</code></pre>
<p>也就是说会将 OG image 指向一个域名，这个域名包含了被 UrlEncode 的文章标题和一些其他内容，可以推测应该也和 Gravatar 差不多，是可以通过 URL 直接提供 OG image 的。</p>
<p>于是我在 GitHub 找到了原来的仓库，也是 Vercel 的一个项目：<a href="https://github.com/vercel/og-image">Open Graph Image as a Service</a>。简言之就是可以直接通过 URL 快速生成带有文字的图片，从而实现不用每张 OG image 都手动制作的效果。既可以直接访问网页在网页上制作，也可以直接使用特定的 URL 就会返回特定的图像。可以说和平常转换机场订阅节点的 API 很像了。</p>
<p>但是 craigary 提供的网址没有 nobelium 的 logo，只显示文字。猜测是指定的 logo URL 失效了吧。</p>
<figure data-type="image" tabindex="9"><img src="https://ws.l3on.site/post-images/244472db-eeec-4ac7-95db-6ee2350da496.png" alt="" loading="lazy"></figure>
<p>访问 Vercel 官方的链接，可以显示并自定义 Logo，但是没有支持中文的字体：</p>
<figure data-type="image" tabindex="10"><img src="https://ws.l3on.site/post-images/cb15aea3-fd30-48db-9bb7-e251ceeb6bd2.png" alt="" loading="lazy"></figure>
<p>这些方块都是中文……</p>
<p>于是自己折腾的机会又到了！</p>
<p>翻了翻 <a href="https://github.com/vercel/og-image">官方仓库</a> 的 issue，发现 <a href="https://github.com/vercel/og-image/issues/108">#108</a> 提到韩语显示问题，果不其然是因为缺少字体。在这条下有 <a href="https://github.com/vercel/og-image/issues/108#issuecomment-657078789">hoosan 的回复</a> 详细说明了他对于同样的日文字体的解决方法。看起来对于中文也是可以适用的。于是我就打算动手自己部署一个，然后修改一下应该就可以解决问题了。</p>
<p>首先我们要自己部署一个原版的 vercel/og-image 项目，同样的还是首先 Fork 一下官方仓库，然后按照 README 的指引修改 <code>vercel.json</code> 文件中的内容，我直接删掉了架构、区域两行，然后调低了一点 memory，rewrite 保持不变，最后文件看起来是这样：</p>
<pre><code class="language-json">{
  &quot;functions&quot;: {
  &quot;api/**&quot;: {
    &quot;memory&quot;: 1024
  }
},
&quot;rewrites&quot;: [
    { &quot;source&quot;: &quot;/(.+)&quot;, &quot;destination&quot;: &quot;/api&quot; }
  ]
}
</code></pre>
<p>现在应该就可以到 Vercel 网站开始部署了，步骤和以前一样，还是从 GitHub 导入，框架选择其他，然后就可以让 Vercel 自动部署了。部署成功后可以打开网页看看，然后就可以开始进一步的修改了。</p>
<p>首先是添加字体文件。</p>
<p>Google Fonts 网站有提供各种 Noto 字体，那种由于字体缺失显示不出来的方框被大家叫做 tofu（豆腐），这套字体之所以叫 Noto，就是想要解决 tofu 问题，这里用这种字体感觉挺合适的。看到项目中其他字体文件都是 woff2 格式的，而 Google Fonts 网站本身不支持 woff2 格式的下载，所以我进行了一些搜索，发现了 <a href="http://google-webfonts-helper.herokuapp.com/fonts">google-webfonts-helper</a> 这个网站，可以直接下载 woff2 格式的字体文件。</p>
<p>我选择下载了 Noto Sans SC medium 字体，勾选中文字符集和 500 字重，滚到页面底部可以直接下载所有字体文件。下载成功后解压，将 woff2 格式的文件保留备用。</p>
<figure data-type="image" tabindex="11"><img src="https://ws.l3on.site/post-images/f3b054b9-ec3c-4e16-ab29-5b2ee28155da.png" alt="" loading="lazy"></figure>
<p>为了方便，我将字体文件更名为了 <code>noto-sans-sc-medium.woff2</code> ，并将该文件添加到自己项目的 <code>api/_fonts</code> 文件夹。</p>
<p>然后打开 <code>api/_lib</code> 文件夹下的 <code>template.ts</code> 文件，声明一个新的 const 读取刚刚的字体文件：</p>
<pre><code class="language-typescript">const noto = readFileSync(`${__dirname}/../_fonts/noto-sans-sc-medium.woff2`).toString('base64');
</code></pre>
<figure data-type="image" tabindex="12"><img src="https://ws.l3on.site/post-images/8029e5f6-6f5c-492b-83e6-1a9014fd095f.png" alt="" loading="lazy"></figure>
<p>同一个文件向下翻，再添加如下一段 CSS 代码在下图位置：</p>
<pre><code class="language-css">@font-face {
  font-family: 'Noto Sans SC';
  font-style:normal;
  font-weight: medium;
  src: url(data:font/woff2;charset=utf-8;base64,${noto}) format('woff2');
}
</code></pre>
<figure data-type="image" tabindex="13"><img src="https://ws.l3on.site/post-images/23f24018-8293-4e7d-b557-bfade3cabf04.png" alt="" loading="lazy"></figure>
<p>接着再向下翻，在 heading class 的 CSS 中添加刚刚的字体：</p>
<figure data-type="image" tabindex="14"><img src="https://ws.l3on.site/post-images/a960ee54-8c22-428e-b8bc-00436312e082.png" alt="" loading="lazy"></figure>
<p>保存结束以上的修改，再将以上的修改推到 GitHub，Vercel 应该又会自动开始部署了，等到部署完成再打开网页，虽然外观没有变化，输入中文试试吧。</p>
<figure data-type="image" tabindex="15"><img src="https://ws.l3on.site/post-images/312cb90b-7c38-4c61-8b08-d0ad0399276b.png" alt="" loading="lazy"></figure>
<p>大功告成，又有图片又有中文支持的自动生成 OG image 网站就完成了。接下来进行一些小调整，使用暗色背景，增加了一个 nobelium 图标，字体大小增大了一点点，大概看起来就是这样：</p>
<figure data-type="image" tabindex="16"><img src="https://ws.l3on.site/post-images/4c310e63-d8e7-4d37-82fd-b8878afa9d0f.png" alt="" loading="lazy"></figure>
<p>但是只在前端操作不是我们的目标，我们做一个可以自动根据文章标题生成对应 OG image 的链接。所以我们点击右侧的图片复制地址，得到了这样的一个 URL</p>
<pre><code class="language-html">https://og-image-l3on.vercel.app/**Hello**%20World%20%E4%B8%AD%E6%96%87%E6%B5%8B%E8%AF%95.png?theme=dark&amp;md=1&amp;fontSize=125px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fvercel-triangle-white.svg&amp;images=https%3A%2F%2Fgithub.com%2FLeonWong0609%2Fnobelium%2Fraw%2Fmain%2FNobelium-Logo.svg&amp;widths=200&amp;widths=200&amp;heights=undefined&amp;heights=200
</code></pre>
<p>可以看到，<code>**Hello**%20World%20%E4%B8%AD%E6%96%87%E6%B5%8B%E8%AF%95</code> 这一段应该就是我们的标题经过 UrlEncode 的文本，<code>.png</code> 是选定的文件类型，而 <code>theme=dark</code> <code>md=1</code> <code>fontSize=125px</code> 等内容就是我们其他的自定义设定了。因此我们现在要做的就是在之前提到的 <code>blog.config.js</code> 和 <code>Container.js</code> 文件中修改使用我们自己的域名和设置就好。</p>
<p>首先将 <code>blog.config.js</code> 文件中的 <code>ogImageGenerateURL</code> 修改为自己部署的 og-image 的域名（Vercel 会自动分配的），然后再到 <code>Container.js</code> 文件中，找到 <code>&lt;meta&gt;</code> 标签下 property 为 <code>og:image</code> 的内容，将包括 <code>.png?theme=</code> 在内后面的内容选中，替换为刚才的那个 URL 中对应的内容即可。下面的 Twitter Card 设置也可以进行一样的修改。我的设置如下：</p>
<pre><code class="language-html">&lt;meta
  property=&quot;og:image&quot;
  content={`${BLOG.ogImageGenerateURL}/${encodeURIComponent(
    meta.title
  )}.png?theme=dark&amp;md=1&amp;fontSize=125px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fvercel-triangle-white.svg&amp;images=https%3A%2F%2Fgithub.com%2FLeonWong0609%2Fnobelium%2Fraw%2Fmain%2FNobelium-Logo.svg&amp;widths=200&amp;widths=200&amp;heights=undefined&amp;heights=200`}
/&gt;
</code></pre>
<pre><code class="language-html">&lt;meta
  name=&quot;twitter:image&quot;
  content={`${BLOG.ogImageGenerateURL}/${encodeURIComponent(
    meta.title
  )}.png?theme=dark&amp;md=1&amp;fontSize=125px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fvercel-triangle-white.svg&amp;images=https%3A%2F%2Fgithub.com%2FLeonWong0609%2Fnobelium%2Fraw%2Fmain%2FNobelium-Logo.svg&amp;widths=200&amp;widths=200&amp;heights=undefined&amp;heights=200`}
/&gt;
</code></pre>
<p>可见这里的内容就是先取刚才的 <code>blog.config.js</code> 中的 <code>ogImageGenerateURL</code> 内容，加上斜杠，再加上 UrlEncode 后的文章标题，再加上一串自己代表特定样式的字符串，拼成了一整个动态生成 OG image 的 URL。</p>
<p>保存修改，再推到 GitHub，等待 Vercel 部署完成，再打开博客，使用检视工具就可以看到 OG image 链接了。再使用 Telegram 和 Twitter 测试一下，完美符合预期！</p>
<figure data-type="image" tabindex="17"><img src="https://ws.l3on.site/post-images/50ff0a20-f926-43ff-b6f8-5a701111cac0.png" alt="" loading="lazy"></figure>
<h2 id="优势">优势</h2>
<p>打开 nobelium 的网页，第一个感觉就是快。比起以前搭建在 GitHub Page 的静态博客，这可快多了，基本看不到加载，点击一个链接后立刻就会有内容显示。</p>
<figure data-type="image" tabindex="18"><img src="https://ws.l3on.site/post-images/74154982-aa1c-4fad-b47e-0b7bde644b2d.png" alt="" loading="lazy"></figure>
<p>作为对比，这里也展示一下原来的 Gridea 静态博客的 Lighthouse 分数：</p>
<figure data-type="image" tabindex="19"><img src="https://ws.l3on.site/post-images/7b0498af-b9c9-455d-9fe4-14efbff1213b.png" alt="" loading="lazy"></figure>
<p>其次，使用 Notion 作为 CMS 也比以往 Gridea 中编辑 Markdown 文件更加方便。以往写一篇博客虽然也可以先在别的地方写，然后在移动到 Gridea 中，但是最后一步的发布还是要在电脑上操作。而且如果博文有图片，还要解决图片问题，要么使用图床，要么就要一个个图片文件导入到 Gridea 中。并且我的 Gridea 可能是因为网络问题，长期无法在客户端 push 成功，我每次都要在客户端点击同步，然后退出，检查 output 文件夹中的静态页面文件是否更新成功，最后再用 Git 手动 Push 一下。比起在 Notion 中编辑完成，把标签直接改成 Published 就能实现发布，实在称不上方便。</p>
<figure data-type="image" tabindex="20"><img src="https://ws.l3on.site/post-images/b50004ca-2c4a-4995-8fce-d25e126e1233.png" alt="" loading="lazy"></figure>
<p>但 nobelium 的方案也称不上完美，还是有几个地方让我怀念 Gridea 的 Markdown 文件。</p>
<p>首先是灵活性收到了一定程度上的限制。Markdown 文件可以直接向上（下？）兼容 HTML，所以有时候一些个别的、需要自定义的元素（比如一些 badge 或者居中的文字什么的）可以直接用 HTML 写出来，但是在 nobelium 下，博文的内容其实就是 Notion 页面的内容，而且也并非支持 Notion 中全部的 block 种类（例如新推出的简单表格、可折叠的标题就还没有支持），文字也无法居中等。可以说对于简单的图文博客，偶尔插个视频那是完全够用，但是如果对于控制博客页面有更高的要求，nobelium 使用 Notion 的方法可能比不上直接使用 Markdown 灵活。</p>
<figure data-type="image" tabindex="21"><img src="https://ws.l3on.site/post-images/d7fa674b-cd68-401e-921e-5b9702d3124c.png" alt="" loading="lazy"></figure>
<p>此外，nobelium 还要从 Notion 中取内容，所以一般会选择公开一个 Notion database，如果选择真的使用 Notion 当作博客的内容管理系统（使用标签区分发布和草稿的内容），那么公开的 database 可能会让一些没有准备好发布的内容公布在互联网上。我个人是完全没有这方面的顾虑，因为我很少直接在 Notion 中写作。nobelium 还提供了一种使用 <code>NOTION_ACCESS_TOKEN</code> 来获取内容的方法，可以不用共享 nobelium 的 Notion database，看起来就是携带 Token 访问 Notion 内容，一个 Token 有效期是 180 天，对于我这种金鱼脑，我自然不会选用这种方法。根据作者 craigary 的 <a href="https://www.notion.so/craigary/Public-Roadmap-3cfc4d0f0ca642ef8f652673c37add22">roadmap</a>，nobelium 未来应该会支持从 Notion 官方的 API 获取内容，最近 Notion API 也正式结束 beta 阶段了，对 craigary 更新表示期待！</p>
<p>最后，我原来的 Gridea 站点已经断断续续打磨了很久，很多细节已经符合我的喜好，这可能算是一次性迁移到 nobelium 的「沉没成本」吧，我无法舍弃原来的 Wonder Space 那快两年的修补、自己加的一堆的样式、Telegram 即时预览模板、OG 属性、还有以前网友的评论。</p>
<h2 id="域名">域名</h2>
<p>折腾完上面的东西，已经过去两天了，但是当时我完全没有停下的意思。有一天看网邻罗二德的 <a href="https://lorde627.xyz">博客</a>，发现他原来的 GitHub Page 有了自己的域名，我就想起来我一直想要有个域名。那天其实已经是凌晨两三点了，但我还是说干就干开始搜索有关购买域名的信息。</p>
<p>我以前看的购买域名之类的内容多是在 GoDaddy 之类的网站购买，需要外币支付手段，当时看到我就被劝退了。那天搜索之后发现其实国内各种云就可以直接购买域名，于是我就在阿里云的万网搜索了一下。不看不知道，我之前一直以为域名一年至少是几顿饭的支出，但我搜了一下我想要的 L3ON 前缀，发现 <code>l3on.site</code> 这个看起来还挺酷的域名一年竟然只要 6 元……我一边后悔怎么没早点动手，一边下单了一年。</p>
<p>在万网购买只需要支付宝账号就可以登录，也可以直接用支付宝绑定的手机号做实名认证。我接受了这种隐私换来的方便（反正我博客内容还是挺阳光的吧），上传身份信息，不到半个小时就搞定了实名认证，当时已经凌晨四点多了，系统提示实名认证可能要 24-48 小时，我就想着睡觉了，过几天再折腾。</p>
<p>结果第二天醒来就看到了收件箱的邮件，当天早上 6:50 我就收到了实名认证通过的消息，希望是机器识别的，不然阿里员工上班时间有点过早了。</p>
<p>Vercel 的域名绑定其实很简单，只需要进入项目的设置，填写自己的域名，然后再在域名的 DNS 设置中加入一条 CNAME 记录就可以了，我出于折腾的本性，还把域名的 DNS 改成了 Cloudflare 的，添加了 CNAME 后，不到五分钟 <code>blog.l3on.site</code> 域名就生效了。记得当时我就对着屏幕，看着浏览器地址栏中这一串在浩瀚互联网世界中代表我的角落的一串字符，一次次刷新页面，觉得一点一点变开心。</p>
<p>原来的 GitHub Page 也可以自定义域名，和 Vercel 一样简单，只需要在仓库的根目录新建一个 <code>CNAME</code> 文件，内容为自己的域名，我选了 <code>ws.l3on.site</code> ，或者直接在 Gridea 的远程设置中填写自己的域名，再把变动 push 到远端就可以了。之后再在 Cloudflare 增加一条 CNAME 记录，指向原来的 <code>github.io</code> 域名即可。现在，我在互联网有两个差不多的角落了。</p>
<h2 id="总结">总结</h2>
<p>所以这两个博客我该留一个放弃一个吗，我暂时觉得我可以一个都不放弃。Gridea 更像一个完整的博客网站，自定义程度更高，但是对应的管理也会相对复杂；nobelium 强大而快捷，让我体验了一把一些相对先进的技术，也给我带来了几个晚上学到新东西的快乐。所以我觉得没必要要求自己二选一。因为博客对于我来说，不是我的工作也不是我的负担，更多是我的玩具，连小孩子都不会拒绝两个玩具，我当然两个都要。</p>
<p>但是我也不想只专注于这些东西而忘记了内容。技术对我有一种莫名的吸引力，总想让我去尝试新的东西，但是真的遇到难对付的问题时，我又往往懒于进行深度系统的学习，可能这也是我为什么长期三脚猫功夫的原因吧。这次整理博客的时候又看了一下我的第一篇博文，我想起我的初心还是想有个自己能写下自己所学所想的东西的地方，之前的两篇随感类的博客比较符合想象中的博客的样子，就是和自己、也和一群看不见的读者分享一些自己最想说的话。</p>
<p>所以前几天折腾完博客，筋疲力尽，开心中又夹杂着一点点负罪感，我怕我又是在玩物丧志，正事不做只知道瞎折腾，虽然有做了很多事情的成就感，但是又觉得如果我什么都不记录下来，就算我当时以为我会了的东西我也会慢慢遗忘，然后这些花费我大量时间的事情似乎没有意义。所以我很庆幸我今天一时冲动就开始打字了，从上午到深夜，一口气写了一万多字，我也被自己惊讶到。未来的一段时间，我可能要从爱好中抽身，转移更多的精力到生活中一些现实的问题上了，所以这篇长文也有点像收心前最后的狂欢吧。</p>
<p>最后的最后，如果你看到了这里，谢谢你。如果文章对你有那么一点点的信息增量甚至是帮助，那是我的荣幸，不论你是在我的哪个角落看到这篇文章，欢迎留言交流，也欢迎你到我另一个角落玩。</p>
<ul>
<li><a href="https://ws.l3on.site">Wonder Space (Gridea / GitHub Page)</a></li>
<li><a href="https://blog.l3on.site">Wonder Space (nobelium / Notion / Vercel)</a></li>
</ul>

            </div>

            
              <a class="animated fadeInUp p-2 items-center text-sm text-gray-700 border hover:bg-gray-300 leading-none rounded-full flex lg:inline-flex m-4 "
                href="https://ws.l3on.site/tag/86oOp5QCV/">
                <span class="flex-auto">
                  博客
                </span>
              </a>
              


                <div class="flex justify-between py-8">
                  
                    <div class="prev-post">
                      <a href="https://ws.l3on.site/post/grammar/">
                        <h3 class="post-title">
                          <i class="ri-arrow-left-line"></i>
                          英文语法简明体系
                        </h3>
                      </a>
                    </div>
                    

                      
                        <div class="next-post">
                          <a href="https://ws.l3on.site/post/been-a-while/">
                            <h3 class="post-title">
                              好久不见
                                <i class="ri-arrow-right-line"></i>
                            </h3>
                          </a>
                        </div>
                        
                </div>

                

<script src="https://giscus.app/client.js"
    data-repo="LeonWong0609/LeonWong0609.github.io"
    data-repo-id="MDEwOlJlcG9zaXRvcnkyMjcyODI0NTM="
    data-category="General"
    data-category-id="DIC_kwDODYwOFc4COnst"
    data-mapping="title"
    data-reactions-enabled="1"
    data-emit-metadata="1"
    data-input-position="top"
    data-theme="transparent_dark"
    data-lang="zh-CN"
    data-loading="lazy"
    crossorigin="anonymous"
    async>
</script>

      </div>
  </div>

  <script src="https://ws.l3on.site/media/prism.js"></script>

<script>

  Prism.highlightAll()
  let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

  // This should probably be throttled.
  // Especially because it triggers during smooth scrolling.
  // https://lodash.com/docs/4.17.10#throttle
  // You could do like...
  // window.addEventListener("scroll", () => {
  //    _.throttle(doThatStuff, 100);
  // });
  // Only not doing it here to keep this Pen dependency-free.

  window.addEventListener("scroll", event => {
    let fromTop = window.scrollY;

    mainNavLinks.forEach((link, index) => {
      let section = document.getElementById(decodeURI(link.hash).substring(1));
      let nextSection = null
      if (mainNavLinks[index + 1]) {
        nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
      }
      if (section.offsetTop <= fromTop) {
        if (nextSection) {
          if (nextSection.offsetTop > fromTop) {
            link.classList.add("current");
          } else {
            link.classList.remove("current");
          }
        } else {
          link.classList.add("current");
        }
      } else {
        link.classList.remove("current");
      }
    });
  });


  document.addEventListener("DOMContentLoaded", function () {
    var lazyImages = [].slice.call(document.querySelectorAll(".post-feature-image.lazy"));

    if ("IntersectionObserver" in window) {
      let lazyImageObserver = new IntersectionObserver(function (entries, observer) {
        entries.forEach(function (entry) {
          if (entry.isIntersecting) {
            let lazyImage = entry.target
            lazyImage.style.backgroundImage = `url(${lazyImage.dataset.bg})`
            lazyImage.classList.remove("lazy")
            lazyImageObserver.unobserve(lazyImage)
          }
        });
      });

      lazyImages.forEach(function (lazyImage) {
        lazyImageObserver.observe(lazyImage)
      })
    } else {
      // Possibly fall back to a more compatible method here
    }
  });

  const menuContainer = document.querySelector('.menu-container')
  const menus = document.querySelectorAll('.menu-container .menu')
  const mask = document.querySelector('.mask')
  const contentWrapper = document.querySelector('.content-wrapper')
  const latestArticle = document.querySelector('.latest-article')
  const readMore = document.querySelector('.read-more')
  const indexPage = document.querySelector('.index-page')

  const isHome = location.pathname === '/'
  if (latestArticle) {
    latestArticle.style.display = isHome ? 'block' : 'none'
    readMore.style.display = isHome ? 'block' : 'none'
    indexPage.style.display = isHome ? 'none' : 'block'
  }

  const openMenu = () => {
    menuContainer.classList.add('open')
    menus.forEach(menu => {
      menu.classList.add('animated', 'fadeInLeft')
    })
    mask.classList.add('open')
    contentWrapper.classList.add('is-second')
  }

  const closeMenu = () => {
    menuContainer.classList.remove('open')
    menus.forEach(menu => {
      menu.classList.remove('animated', 'fadeInLeft')
    })
    mask.classList.remove('open')
    contentWrapper.classList.remove('is-second')
  }
</script>
</body>

</html>